<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>WizardsToolkit: twofish.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.4 -->
<div class="nav">
<a class="el" href="dir_cd3570322bb5d2bd837f4a567e369f40.html">wizard</a></div>
<h1>twofish.c File Reference</h1>
<p>
<code>#include &quot;<a class="el" href="studio_8h-source.html">wizard/studio.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="exception_8h-source.html">wizard/exception.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="exception-private_8h-source.html">wizard/exception-private.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="memory___8h-source.html">wizard/memory_.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="twofish_8h-source.html">wizard/twofish.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__TwofishInfo.html">_TwofishInfo</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#fd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#d64281fa2d8847d97595b2ccb9d89283">ReadInt32</a>(value, p)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#6bd56b8c64565f6f32a53818d9dac6c9">TwofishBlocksize</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#b14b639083a1c97ba91306664acd65ac">WriteInt32</a>(p, value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#73768dee804fef381d3a96ad50c995df">DecryptRound</a>(alpha, beta, gamma, delta, i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#7b87b782eb9ba32c878ccdb5d01e11f1">EncryptRound</a>(alpha, beta, gamma, delta, i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#ac8041823691a84baee74c3a49941e7d">K128</a>(x, j, k, l, m, n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#0e29e2f1f20f40828b808089397d16e5">K192</a>(x, j, k, l, m, n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#167c4d7ab558ad486e151c064a4abd36">K256</a>(x, j, k, l, m, n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#3a30f68e1f340d0e40532f49a3530b14">MaximumTwofishKeyLength</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#b935f9a8cc94e8e0e763d275ca656f14">Q128</a>(alpha, beta, gamma, delta, i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(alpha, beta, gamma, delta, i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(alpha, beta, i)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#4eed86d8ae6a219a8b661d1f3237e271">Sbox</a>(alpha, beta, gamma, delta, i, w, x, y, z)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#57508b4129b9d2ace5745bfd17e6851b">AcquireTwofishInfo</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#ba27fccb23c89ef5411eedee40ba640d">DecryptTwofishBlock</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const unsigned char *ciphertext, unsigned char *plaintext)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#ac801906a2c582f3158c154c096a3ccb">DestroyTwofishInfo</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#22e8a2ddb07d253c3a7eb6b973b0df56">EncryptTwofishBlock</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const unsigned char *plaintext, unsigned char *ciphertext)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#8e3f413c59107e89509f0dd2bbf29a15">GetTwofishBlocksize</a> (const <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#ae486ea1d1df86418c22ccdaa2c9b9aa">SetTwofishKey</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const <a class="el" href="struct__StringInfo.html">StringInfo</a> *key)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="73768dee804fef381d3a96ad50c995df"></a><!-- doxytag: member="twofish.c::DecryptRound" ref="73768dee804fef381d3a96ad50c995df" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DecryptRound          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">delta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha); sigma=<a class="code" href="twofish_8c.html#fd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta); rho+=sigma; sigma+=rho; \
  delta^=sigma+twofish_info-&gt;k[2*(i)+1]; delta=(delta &gt;&gt; 1)+(delta &lt;&lt; 31); \
  gamma=(gamma &lt;&lt; 1)+(gamma &gt;&gt; 31); gamma^=(rho+twofish_info-&gt;k[2*(i)]); \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="7b87b782eb9ba32c878ccdb5d01e11f1"></a><!-- doxytag: member="twofish.c::EncryptRound" ref="7b87b782eb9ba32c878ccdb5d01e11f1" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EncryptRound          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">delta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha); sigma=<a class="code" href="twofish_8c.html#fd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta); \
  rho+=sigma; sigma+=rho+twofish_info-&gt;k[2*(i)+1]; \
  gamma^=rho+twofish_info-&gt;k[2*(i)]; gamma=(gamma &gt;&gt; 1)+(gamma &lt;&lt; 31); \
  delta=((delta &lt;&lt; 1)+(delta &gt;&gt; 31)) ^ sigma; \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="59e8fd828ed415418006fdb4fb225a09"></a><!-- doxytag: member="twofish.c::G1" ref="59e8fd828ed415418006fdb4fb225a09" args="(alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G1          </td>
          <td>(</td>
          <td class="paramtype">alpha&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(twofish_info-&gt;sbox[0][(alpha) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[1][((alpha) &gt;&gt; 8) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[2][((alpha) &gt;&gt; 16) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[3][(alpha) &gt;&gt; 24])
</pre></div>
</div>
</div><p>
<a class="anchor" name="fd86c2db5e8f4f34418bc6965cfded76"></a><!-- doxytag: member="twofish.c::G2" ref="fd86c2db5e8f4f34418bc6965cfded76" args="(beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G2          </td>
          <td>(</td>
          <td class="paramtype">beta&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">(twofish_info-&gt;sbox[1][(beta) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[2][((beta) &gt;&gt; 8) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[3][((beta) &gt;&gt; 16) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[0][(beta) &gt;&gt; 24])
</pre></div>
</div>
</div><p>
<a class="anchor" name="ac8041823691a84baee74c3a49941e7d"></a><!-- doxytag: member="twofish.c::K128" ref="ac8041823691a84baee74c3a49941e7d" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K128          </td>
          <td>(</td>
          <td class="paramtype">x,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">j,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">k,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">m,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#b935f9a8cc94e8e0e763d275ca656f14">Q128</a>(k,l,k,l,0); sigma=<a class="code" href="twofish_8c.html#b935f9a8cc94e8e0e763d275ca656f14">Q128</a>(m,n,m,n,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="0e29e2f1f20f40828b808089397d16e5"></a><!-- doxytag: member="twofish.c::K192" ref="0e29e2f1f20f40828b808089397d16e5" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K192          </td>
          <td>(</td>
          <td class="paramtype">x,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">j,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">k,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">m,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(l,l,k,k,0); sigma=<a class="code" href="twofish_8c.html#0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(n,n,m,m,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="167c4d7ab558ad486e151c064a4abd36"></a><!-- doxytag: member="twofish.c::K256" ref="167c4d7ab558ad486e151c064a4abd36" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K256          </td>
          <td>(</td>
          <td class="paramtype">x,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">j,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">k,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">m,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">n&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(k,l,0); sigma=<a class="code" href="twofish_8c.html#2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(m,n,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="3a30f68e1f340d0e40532f49a3530b14"></a><!-- doxytag: member="twofish.c::MaximumTwofishKeyLength" ref="3a30f68e1f340d0e40532f49a3530b14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MaximumTwofishKeyLength&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="b935f9a8cc94e8e0e763d275ca656f14"></a><!-- doxytag: member="twofish.c::Q128" ref="b935f9a8cc94e8e0e763d275ca656f14" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q128          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">delta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">mds[0][q0[alpha ^ crypt_key[(i)+8]] ^ crypt_key[i]] ^ \
  mds[1][q0[beta ^ crypt_key[(i)+9]] ^ crypt_key[(i)+1]] ^ \
  mds[2][q1[gamma ^ crypt_key[(i)+10]] ^ crypt_key[(i)+2]] ^ \
  mds[3][q1[delta ^ crypt_key[(i)+11]] ^ crypt_key[(i)+3]]
</pre></div>
</div>
</div><p>
<a class="anchor" name="0d5702f5c4fc7f6cc74d8ae5ca39afed"></a><!-- doxytag: member="twofish.c::Q192" ref="0d5702f5c4fc7f6cc74d8ae5ca39afed" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q192          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">delta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="twofish_8c.html#b935f9a8cc94e8e0e763d275ca656f14">Q128</a>(q0[alpha ^ crypt_key[(i)+16]],q1[beta ^ crypt_key[(i)+17]], \
    q0[gamma ^ crypt_key[(i)+18]],q1[delta ^ crypt_key[(i)+19]],i)
</pre></div>
</div>
</div><p>
<a class="anchor" name="2f9b3ce93082eb364c26f691c6105c0b"></a><!-- doxytag: member="twofish.c::Q256" ref="2f9b3ce93082eb364c26f691c6105c0b" args="(alpha, beta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q256          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="twofish_8c.html#0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(q1[beta ^ crypt_key[(i)+24]],q1[alpha ^ crypt_key[(i)+25]], \
    q0[alpha ^ crypt_key[(i)+26]],q0[beta ^ crypt_key[(i)+27]],i)
</pre></div>
</div>
</div><p>
<a class="anchor" name="d64281fa2d8847d97595b2ccb9d89283"></a><!-- doxytag: member="twofish.c::ReadInt32" ref="d64281fa2d8847d97595b2ccb9d89283" args="(value, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ReadInt32          </td>
          <td>(</td>
          <td class="paramtype">value,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">p&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  (value)=(*p++); \
  (value)|=(*p++) &lt;&lt; 8; \
  (value)|=(*p++) &lt;&lt; 16; \
  (value)|=(*p++) &lt;&lt; 24; \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="4eed86d8ae6a219a8b661d1f3237e271"></a><!-- doxytag: member="twofish.c::Sbox" ref="4eed86d8ae6a219a8b661d1f3237e271" args="(alpha, beta, gamma, delta, i, w, x, y, z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Sbox          </td>
          <td>(</td>
          <td class="paramtype">alpha,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">beta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gamma,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">delta,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">i,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">w,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">x,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">y,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">z&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  <span class="keywordflow">if</span> (crypt_key[i] != 0) \
    { \
      xi=polynomial_to_exponent[crypt_key[i]-1]; \
      (alpha)^=exponent_to_polynomial[xi+(w)]; \
      (beta)^=exponent_to_polynomial[xi+(x)]; \
      (gamma)^=exponent_to_polynomial[xi+(y)]; \
      (delta)^=exponent_to_polynomial[xi+(z)]; \
   } \
}
</pre></div>
</div>
</div><p>
<a class="anchor" name="6bd56b8c64565f6f32a53818d9dac6c9"></a><!-- doxytag: member="twofish.c::TwofishBlocksize" ref="6bd56b8c64565f6f32a53818d9dac6c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TwofishBlocksize&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="b14b639083a1c97ba91306664acd65ac"></a><!-- doxytag: member="twofish.c::WriteInt32" ref="b14b639083a1c97ba91306664acd65ac" args="(p, value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WriteInt32          </td>
          <td>(</td>
          <td class="paramtype">p,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">value&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  *p++=(<span class="keywordtype">unsigned</span> char) (value); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 8); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 16); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 24); \
}
</pre></div>
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="57508b4129b9d2ace5745bfd17e6851b"></a><!-- doxytag: member="twofish.c::AcquireTwofishInfo" ref="57508b4129b9d2ace5745bfd17e6851b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a>* AcquireTwofishInfo           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ba27fccb23c89ef5411eedee40ba640d"></a><!-- doxytag: member="twofish.c::DecryptTwofishBlock" ref="ba27fccb23c89ef5411eedee40ba640d" args="(TwofishInfo *twofish_info, const unsigned char *ciphertext, unsigned char *plaintext)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void DecryptTwofishBlock           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>plaintext</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ac801906a2c582f3158c154c096a3ccb"></a><!-- doxytag: member="twofish.c::DestroyTwofishInfo" ref="ac801906a2c582f3158c154c096a3ccb" args="(TwofishInfo *twofish_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a>* DestroyTwofishInfo           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="22e8a2ddb07d253c3a7eb6b973b0df56"></a><!-- doxytag: member="twofish.c::EncryptTwofishBlock" ref="22e8a2ddb07d253c3a7eb6b973b0df56" args="(TwofishInfo *twofish_info, const unsigned char *plaintext, unsigned char *ciphertext)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void EncryptTwofishBlock           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ciphertext</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8e3f413c59107e89509f0dd2bbf29a15"></a><!-- doxytag: member="twofish.c::GetTwofishBlocksize" ref="8e3f413c59107e89509f0dd2bbf29a15" args="(const TwofishInfo *twofish_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport unsigned int GetTwofishBlocksize           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="ae486ea1d1df86418c22ccdaa2c9b9aa"></a><!-- doxytag: member="twofish.c::SetTwofishKey" ref="ae486ea1d1df86418c22ccdaa2c9b9aa" args="(TwofishInfo *twofish_info, const StringInfo *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void SetTwofishKey           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__StringInfo.html">StringInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Jan 26 14:50:33 2008 for WizardsToolkit by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.4 </small></address>
</body>
</html>
