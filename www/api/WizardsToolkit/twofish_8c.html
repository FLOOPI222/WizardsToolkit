<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WizardsToolkit: twofish.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_cd3570322bb5d2bd837f4a567e369f40.html">wizard</a>      </li>
    </ul>
  </div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>twofish.c File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &quot;<a class="el" href="studio_8h_source.html">wizard/studio.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="exception_8h_source.html">wizard/exception.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="exception-private_8h_source.html">wizard/exception-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memory___8h_source.html">wizard/memory_.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="twofish_8h_source.html">wizard/twofish.h</a>&quot;</code><br/>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__TwofishInfo.html">_TwofishInfo</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#afd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#af909ea0364c607719e87adf4d9036804">Read32Bits</a>(value, p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a6bd56b8c64565f6f32a53818d9dac6c9">TwofishBlocksize</a>&nbsp;&nbsp;&nbsp;16</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a04f16ea7be358d8e23350b684489f6a0">Write32Bits</a>(p, value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#af2fe721c77bf2cdb3ff9ea8d5e75d1e6">DecipherRound</a>(alpha, beta, gamma, delta, i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a91c14354c7b1a76eddc55327246824eb">EncipherRound</a>(alpha, beta, gamma, delta, i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#aac8041823691a84baee74c3a49941e7d">K128</a>(x, j, k, l, m, n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a0e29e2f1f20f40828b808089397d16e5">K192</a>(x, j, k, l, m, n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a167c4d7ab558ad486e151c064a4abd36">K256</a>(x, j, k, l, m, n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a3a30f68e1f340d0e40532f49a3530b14">MaximumTwofishKeyLength</a>&nbsp;&nbsp;&nbsp;32</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#ab935f9a8cc94e8e0e763d275ca656f14">Q128</a>(alpha, beta, gamma, delta, i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(alpha, beta, gamma, delta, i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(alpha, beta, i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a4eed86d8ae6a219a8b661d1f3237e271">Sbox</a>(alpha, beta, gamma, delta, i, w, x, y, z)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a57508b4129b9d2ace5745bfd17e6851b">AcquireTwofishInfo</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a82865eab53533097c700ea3f1005a021">DecipherTwofishBlock</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const unsigned char *ciphertext, unsigned char *plaintext)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#aac801906a2c582f3158c154c096a3ccb">DestroyTwofishInfo</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a000f81f19317f3edcca5d8a6a39ca7f2">EncipherTwofishBlock</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const unsigned char *plaintext, unsigned char *ciphertext)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#a8e3f413c59107e89509f0dd2bbf29a15">GetTwofishBlocksize</a> (const <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">WizardExport void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="twofish_8c.html#aae486ea1d1df86418c22ccdaa2c9b9aa">SetTwofishKey</a> (<a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *twofish_info, const <a class="el" href="struct__StringInfo.html">StringInfo</a> *key)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="af2fe721c77bf2cdb3ff9ea8d5e75d1e6"></a><!-- doxytag: member="twofish.c::DecipherRound" ref="af2fe721c77bf2cdb3ff9ea8d5e75d1e6" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DecipherRound</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">gamma, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">delta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#a59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha); sigma=<a class="code" href="twofish_8c.html#afd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta); rho+=sigma; sigma+=rho; \
  delta^=sigma+twofish_info-&gt;k[2*(i)+1]; delta=(delta &gt;&gt; 1)+(delta &lt;&lt; 31); \
  gamma=(gamma &lt;&lt; 1)+(gamma &gt;&gt; 31); gamma^=(rho+twofish_info-&gt;k[2*(i)]); \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8c.html#a82865eab53533097c700ea3f1005a021">DecipherTwofishBlock()</a>.</p>

</div>
</div>
<a class="anchor" id="a91c14354c7b1a76eddc55327246824eb"></a><!-- doxytag: member="twofish.c::EncipherRound" ref="a91c14354c7b1a76eddc55327246824eb" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EncipherRound</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">gamma, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">delta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#a59e8fd828ed415418006fdb4fb225a09">G1</a>(alpha); sigma=<a class="code" href="twofish_8c.html#afd86c2db5e8f4f34418bc6965cfded76">G2</a>(beta); \
  rho+=sigma; sigma+=rho+twofish_info-&gt;k[2*(i)+1]; \
  gamma^=rho+twofish_info-&gt;k[2*(i)]; gamma=(gamma &gt;&gt; 1)+(gamma &lt;&lt; 31); \
  delta=((delta &lt;&lt; 1)+(delta &gt;&gt; 31)) ^ sigma; \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8c.html#a000f81f19317f3edcca5d8a6a39ca7f2">EncipherTwofishBlock()</a>.</p>

</div>
</div>
<a class="anchor" id="a59e8fd828ed415418006fdb4fb225a09"></a><!-- doxytag: member="twofish.c::G1" ref="a59e8fd828ed415418006fdb4fb225a09" args="(alpha)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G1</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(twofish_info-&gt;sbox[0][(alpha) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[1][((alpha) &gt;&gt; 8) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[2][((alpha) &gt;&gt; 16) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[3][(alpha) &gt;&gt; 24])
</pre></div>
</div>
</div>
<a class="anchor" id="afd86c2db5e8f4f34418bc6965cfded76"></a><!-- doxytag: member="twofish.c::G2" ref="afd86c2db5e8f4f34418bc6965cfded76" args="(beta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G2</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(twofish_info-&gt;sbox[1][(beta) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[2][((beta) &gt;&gt; 8) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[3][((beta) &gt;&gt; 16) &amp; 0xFF]) ^ \
  (twofish_info-&gt;sbox[0][(beta) &gt;&gt; 24])
</pre></div>
</div>
</div>
<a class="anchor" id="aac8041823691a84baee74c3a49941e7d"></a><!-- doxytag: member="twofish.c::K128" ref="aac8041823691a84baee74c3a49941e7d" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K128</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">l, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">n</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#ab935f9a8cc94e8e0e763d275ca656f14">Q128</a>(k,l,k,l,0); sigma=<a class="code" href="twofish_8c.html#ab935f9a8cc94e8e0e763d275ca656f14">Q128</a>(m,n,m,n,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8h.html#a47bdd5fc0cba35cab2bf660bd512b280">SetTwofishKey()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e29e2f1f20f40828b808089397d16e5"></a><!-- doxytag: member="twofish.c::K192" ref="a0e29e2f1f20f40828b808089397d16e5" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K192</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">l, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">n</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#a0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(l,l,k,k,0); sigma=<a class="code" href="twofish_8c.html#a0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(n,n,m,m,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8h.html#a47bdd5fc0cba35cab2bf660bd512b280">SetTwofishKey()</a>.</p>

</div>
</div>
<a class="anchor" id="a167c4d7ab558ad486e151c064a4abd36"></a><!-- doxytag: member="twofish.c::K256" ref="a167c4d7ab558ad486e151c064a4abd36" args="(x, j, k, l, m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define K256</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">k, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">l, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">n</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  rho=<a class="code" href="twofish_8c.html#a2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(k,l,0); sigma=<a class="code" href="twofish_8c.html#a2f9b3ce93082eb364c26f691c6105c0b">Q256</a>(m,n,4); \
  sigma=(sigma &lt;&lt; 8)+(sigma &gt;&gt; 24); rho+=sigma; sigma+=rho; \
  twofish_info-&gt;x[j]=rho; twofish_info-&gt;x[(j)+1]=(sigma &lt;&lt; 9)+(sigma &gt;&gt; 23); \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8h.html#a47bdd5fc0cba35cab2bf660bd512b280">SetTwofishKey()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a30f68e1f340d0e40532f49a3530b14"></a><!-- doxytag: member="twofish.c::MaximumTwofishKeyLength" ref="a3a30f68e1f340d0e40532f49a3530b14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MaximumTwofishKeyLength&nbsp;&nbsp;&nbsp;32</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="twofish_8h.html#a47bdd5fc0cba35cab2bf660bd512b280">SetTwofishKey()</a>.</p>

</div>
</div>
<a class="anchor" id="ab935f9a8cc94e8e0e763d275ca656f14"></a><!-- doxytag: member="twofish.c::Q128" ref="ab935f9a8cc94e8e0e763d275ca656f14" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q128</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">gamma, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">delta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">mds[0][q0[alpha ^ crypt_key[(i)+8]] ^ crypt_key[i]] ^ \
  mds[1][q0[beta ^ crypt_key[(i)+9]] ^ crypt_key[(i)+1]] ^ \
  mds[2][q1[gamma ^ crypt_key[(i)+10]] ^ crypt_key[(i)+2]] ^ \
  mds[3][q1[delta ^ crypt_key[(i)+11]] ^ crypt_key[(i)+3]]
</pre></div>
</div>
</div>
<a class="anchor" id="a0d5702f5c4fc7f6cc74d8ae5ca39afed"></a><!-- doxytag: member="twofish.c::Q192" ref="a0d5702f5c4fc7f6cc74d8ae5ca39afed" args="(alpha, beta, gamma, delta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q192</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">gamma, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">delta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="twofish_8c.html#ab935f9a8cc94e8e0e763d275ca656f14">Q128</a>(q0[alpha ^ crypt_key[(i)+16]],q1[beta ^ crypt_key[(i)+17]], \
    q0[gamma ^ crypt_key[(i)+18]],q1[delta ^ crypt_key[(i)+19]],i)
</pre></div>
</div>
</div>
<a class="anchor" id="a2f9b3ce93082eb364c26f691c6105c0b"></a><!-- doxytag: member="twofish.c::Q256" ref="a2f9b3ce93082eb364c26f691c6105c0b" args="(alpha, beta, i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Q256</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><a class="code" href="twofish_8c.html#a0d5702f5c4fc7f6cc74d8ae5ca39afed">Q192</a>(q1[beta ^ crypt_key[(i)+24]],q1[alpha ^ crypt_key[(i)+25]], \
    q0[alpha ^ crypt_key[(i)+26]],q0[beta ^ crypt_key[(i)+27]],i)
</pre></div>
</div>
</div>
<a class="anchor" id="af909ea0364c607719e87adf4d9036804"></a><!-- doxytag: member="twofish.c::Read32Bits" ref="af909ea0364c607719e87adf4d9036804" args="(value, p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Read32Bits</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">value, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">p</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  (value)=(*p++); \
  (value)|=(*p++) &lt;&lt; 8; \
  (value)|=(*p++) &lt;&lt; 16; \
  (value)|=(*p++) &lt;&lt; 24; \
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4eed86d8ae6a219a8b661d1f3237e271"></a><!-- doxytag: member="twofish.c::Sbox" ref="a4eed86d8ae6a219a8b661d1f3237e271" args="(alpha, beta, gamma, delta, i, w, x, y, z)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Sbox</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">alpha, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">beta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">gamma, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">delta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">i, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">w, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">y, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">z</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  <span class="keywordflow">if</span> (crypt_key[i] != 0) \
    { \
      xi=polynomial_to_exponent[crypt_key[i]-1]; \
      (alpha)^=exponent_to_polynomial[xi+(w)]; \
      (beta)^=exponent_to_polynomial[xi+(x)]; \
      (gamma)^=exponent_to_polynomial[xi+(y)]; \
      (delta)^=exponent_to_polynomial[xi+(z)]; \
   } \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8h.html#a47bdd5fc0cba35cab2bf660bd512b280">SetTwofishKey()</a>.</p>

</div>
</div>
<a class="anchor" id="a6bd56b8c64565f6f32a53818d9dac6c9"></a><!-- doxytag: member="twofish.c::TwofishBlocksize" ref="a6bd56b8c64565f6f32a53818d9dac6c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TwofishBlocksize&nbsp;&nbsp;&nbsp;16</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a04f16ea7be358d8e23350b684489f6a0"></a><!-- doxytag: member="twofish.c::Write32Bits" ref="a04f16ea7be358d8e23350b684489f6a0" args="(p, value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Write32Bits</td>
          <td>(</td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">p, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname">value</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">{ \
  *p++=(<span class="keywordtype">unsigned</span> char) (value); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 8); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 16); \
  *p++=(<span class="keywordtype">unsigned</span> char) ((value) &gt;&gt; 24); \
}
</pre></div>
<p>Referenced by <a class="el" href="twofish_8c.html#a82865eab53533097c700ea3f1005a021">DecipherTwofishBlock()</a>, and <a class="el" href="twofish_8c.html#a000f81f19317f3edcca5d8a6a39ca7f2">EncipherTwofishBlock()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a57508b4129b9d2ace5745bfd17e6851b"></a><!-- doxytag: member="twofish.c::AcquireTwofishInfo" ref="a57508b4129b9d2ace5745bfd17e6851b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a>* AcquireTwofishInfo </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="memory_8c.html#abbbed8fc169d0791993d6c5556af9574">AcquireWizardMemory()</a>, <a class="el" href="struct__TwofishInfo.html#ae3caaaf58effc8f8f1551bf23bc6ccda">_TwofishInfo::blocksize</a>, <a class="el" href="exception_8h.html#a0595b41cfb7d03f18438f9c355a3469da6a407747b50f2484cb4abc2f5783e6b4">CipherDomain</a>, <a class="el" href="exception_8h.html#ab0df38968e4f03a3f1f6d6df0f31f45aae78c711dd9a3a19d8175eb124b17611c">MemoryError</a>, <a class="el" href="memory_8c.html#a90af574d27fed83b2fc5e3fa5de3e86c">ResetWizardMemory()</a>, <a class="el" href="struct__TwofishInfo.html#a4f0b34c4c02358252ccdf787d097e308">_TwofishInfo::signature</a>, <a class="el" href="exception-private_8h.html#ab21cec2c0ab4830b8831af4c483d1c0c">ThrowWizardFatalError</a>, and <a class="el" href="struct__TwofishInfo.html#aa18a254d977bdb67c0f99ad37dddf9a4">_TwofishInfo::timestamp</a>.</p>

<p>Referenced by <a class="el" href="cipher_8c.html#a23e1e8677990a88ce9c839a16738574b">AcquireCipherInfo()</a>.</p>

</div>
</div>
<a class="anchor" id="a82865eab53533097c700ea3f1005a021"></a><!-- doxytag: member="twofish.c::DecipherTwofishBlock" ref="a82865eab53533097c700ea3f1005a021" args="(TwofishInfo *twofish_info, const unsigned char *ciphertext, unsigned char *plaintext)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void DecipherTwofishBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>plaintext</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="twofish_8c.html#af2fe721c77bf2cdb3ff9ea8d5e75d1e6">DecipherRound</a>, <a class="el" href="struct__TwofishInfo.html#a0f61b65818da094b97fc3ea247ea4c7d">_TwofishInfo::w</a>, and <a class="el" href="twofish_8c.html#a04f16ea7be358d8e23350b684489f6a0">Write32Bits</a>.</p>

<p>Referenced by <a class="el" href="cipher_8c.html#a23e1e8677990a88ce9c839a16738574b">AcquireCipherInfo()</a>.</p>

</div>
</div>
<a class="anchor" id="aac801906a2c582f3158c154c096a3ccb"></a><!-- doxytag: member="twofish.c::DestroyTwofishInfo" ref="aac801906a2c582f3158c154c096a3ccb" args="(TwofishInfo *twofish_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a>* DestroyTwofishInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="exception_8h.html#a0595b41cfb7d03f18438f9c355a3469da6a407747b50f2484cb4abc2f5783e6b4">CipherDomain</a>, <a class="el" href="log_8h.html#aeeb9bbe616eb1b8c7097bc3b2e9a4e69">GetWizardModule</a>, <a class="el" href="log_8c.html#a081cdad426b375fa99eb943f2eebf8e5">LogWizardEvent()</a>, <a class="el" href="memory_8c.html#ae75c757c62a497a7cad4ca248f24a362">RelinquishWizardMemory()</a>, <a class="el" href="struct__TwofishInfo.html#a4f0b34c4c02358252ccdf787d097e308">_TwofishInfo::signature</a>, <a class="el" href="log_8h.html#a5d4d59a282badd09dd3b71cb216cab60aa01af1d7c16041cb09cba96de6961e0e">TraceEvent</a>, <a class="el" href="exception-private_8h.html#a15135a1668653c53c4d75046fea0502b">WizardAssert</a>, and <a class="el" href="studio_8h.html#aee494dc2ebec148772492b1cdddf7f1e">WizardSignature</a>.</p>

<p>Referenced by <a class="el" href="cipher_8h.html#a0ebf18e2762af5205bb14a0e240876c4">DestroyCipherInfo()</a>.</p>

</div>
</div>
<a class="anchor" id="a000f81f19317f3edcca5d8a6a39ca7f2"></a><!-- doxytag: member="twofish.c::EncipherTwofishBlock" ref="a000f81f19317f3edcca5d8a6a39ca7f2" args="(TwofishInfo *twofish_info, const unsigned char *plaintext, unsigned char *ciphertext)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void EncipherTwofishBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ciphertext</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="twofish_8c.html#a91c14354c7b1a76eddc55327246824eb">EncipherRound</a>, <a class="el" href="struct__TwofishInfo.html#a0f61b65818da094b97fc3ea247ea4c7d">_TwofishInfo::w</a>, and <a class="el" href="twofish_8c.html#a04f16ea7be358d8e23350b684489f6a0">Write32Bits</a>.</p>

<p>Referenced by <a class="el" href="cipher_8c.html#a23e1e8677990a88ce9c839a16738574b">AcquireCipherInfo()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e3f413c59107e89509f0dd2bbf29a15"></a><!-- doxytag: member="twofish.c::GetTwofishBlocksize" ref="a8e3f413c59107e89509f0dd2bbf29a15" args="(const TwofishInfo *twofish_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport unsigned int GetTwofishBlocksize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="struct__TwofishInfo.html#ae3caaaf58effc8f8f1551bf23bc6ccda">_TwofishInfo::blocksize</a>, <a class="el" href="exception_8h.html#a0595b41cfb7d03f18438f9c355a3469da6a407747b50f2484cb4abc2f5783e6b4">CipherDomain</a>, <a class="el" href="log_8h.html#aeeb9bbe616eb1b8c7097bc3b2e9a4e69">GetWizardModule</a>, <a class="el" href="log_8c.html#a081cdad426b375fa99eb943f2eebf8e5">LogWizardEvent()</a>, <a class="el" href="struct__TwofishInfo.html#a4f0b34c4c02358252ccdf787d097e308">_TwofishInfo::signature</a>, <a class="el" href="log_8h.html#a5d4d59a282badd09dd3b71cb216cab60aa01af1d7c16041cb09cba96de6961e0e">TraceEvent</a>, <a class="el" href="exception-private_8h.html#a15135a1668653c53c4d75046fea0502b">WizardAssert</a>, and <a class="el" href="studio_8h.html#aee494dc2ebec148772492b1cdddf7f1e">WizardSignature</a>.</p>

<p>Referenced by <a class="el" href="cipher_8c.html#a23e1e8677990a88ce9c839a16738574b">AcquireCipherInfo()</a>.</p>

</div>
</div>
<a class="anchor" id="aae486ea1d1df86418c22ccdaa2c9b9aa"></a><!-- doxytag: member="twofish.c::SetTwofishKey" ref="aae486ea1d1df86418c22ccdaa2c9b9aa" args="(TwofishInfo *twofish_info, const StringInfo *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WizardExport void SetTwofishKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__TwofishInfo.html">TwofishInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>twofish_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct__StringInfo.html">StringInfo</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="exception_8h.html#a0595b41cfb7d03f18438f9c355a3469da6a407747b50f2484cb4abc2f5783e6b4">CipherDomain</a>, <a class="el" href="string_8c.html#aeb2bc71a5a41b3a93ee514453916a505">GetStringInfoDatum()</a>, <a class="el" href="string_8c.html#a8880bc779e78d1ccdfc3e36d90cbcbff">GetStringInfoLength()</a>, <a class="el" href="log_8h.html#aeeb9bbe616eb1b8c7097bc3b2e9a4e69">GetWizardModule</a>, <a class="el" href="twofish_8c.html#aac8041823691a84baee74c3a49941e7d">K128</a>, <a class="el" href="twofish_8c.html#a0e29e2f1f20f40828b808089397d16e5">K192</a>, <a class="el" href="twofish_8c.html#a167c4d7ab558ad486e151c064a4abd36">K256</a>, <a class="el" href="log_8c.html#a081cdad426b375fa99eb943f2eebf8e5">LogWizardEvent()</a>, <a class="el" href="twofish_8c.html#a3a30f68e1f340d0e40532f49a3530b14">MaximumTwofishKeyLength</a>, <a class="el" href="studio_8h.html#a202767af7f06cef8e1c69d9771f157c3">Min</a>, <a class="el" href="memory_8c.html#a90af574d27fed83b2fc5e3fa5de3e86c">ResetWizardMemory()</a>, <a class="el" href="struct__TwofishInfo.html#abfe3a25a9ed338ad54ee10961302175c">_TwofishInfo::sbox</a>, <a class="el" href="twofish_8c.html#a4eed86d8ae6a219a8b661d1f3237e271">Sbox</a>, <a class="el" href="struct__TwofishInfo.html#a4f0b34c4c02358252ccdf787d097e308">_TwofishInfo::signature</a>, <a class="el" href="log_8h.html#a5d4d59a282badd09dd3b71cb216cab60aa01af1d7c16041cb09cba96de6961e0e">TraceEvent</a>, <a class="el" href="exception-private_8h.html#a15135a1668653c53c4d75046fea0502b">WizardAssert</a>, and <a class="el" href="studio_8h.html#aee494dc2ebec148772492b1cdddf7f1e">WizardSignature</a>.</p>

<p>Referenced by <a class="el" href="cipher_8h.html#a4e2a5fcfc4cd15aec8329aefe9e06b3c">SetCipherKey()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
